<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hollandé©—ï¼ˆ10é¡Œï¼‰</title>
  <style>
:root{
  /* Base */
  --bg:#fbfbfd;
  --ink:#0f172a;          /* æ·±å¢¨è— */
  --muted:#667085;        /* éœ§ç°è— */
  --card:#ffffff;
  --line:#e6eaf2;

  /* Brand / Accentï¼ˆä¸»è‰²ï¼šè—ç¶  + è¼”è‰²ï¼šé›è—ï¼‰ */
  --accent:#1fa8a8;       /* teal */
  --accent2:#4f46e5;      /* indigo */
  --accentSoft:#e6f7f7;   /* teal very light */
  --accentSoft2:#eef2ff;  /* indigo very light */

  /* Result header / name bar */
  --purple: linear-gradient(135deg, #1fa8a8, #4f46e5);
  --bluebar:#eaf6ff;

  /* Shadow / radius */
  --shadow: 0 10px 28px rgba(15,23,42,.08);
  --radius:16px;

  /* RIASEC bar colorsï¼ˆæŸ”å’Œä½†æœ‰è¾¨è­˜åº¦ï¼‰ */
  --cE:#f2b35e; /* warm amber */
  --cC:#f29d8f; /* soft coral */
  --cI:#70b7ff; /* calm sky */
  --cS:#63c6b5; /* mint teal */
  --cR:#7f9cff; /* periwinkle */
  --cA:#c48cf2; /* lavender */
}

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
      background:linear-gradient(180deg, #f6f8fc, #fbfbfd);

      color:var(--ink);
      min-height:100vh;
      display:flex;
      justify-content:center;
    }
    .wrap{width:min(1020px, 100%); padding:18px 14px 70px}

    /* top step header (for question pages) */
    .topbar{
      display:flex;gap:14px;align-items:center;justify-content:space-between;
      padding:14px 16px;border:1px solid var(--line);
      background: rgba(255,255,255,.85);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      position:sticky;top:10px;z-index:10;backdrop-filter: blur(10px);
      margin-bottom:14px;
    }
    .title{display:flex;flex-direction:column;gap:6px}
    .title h1{margin:0;font-size:18px;font-weight:900}
    .title p{margin:0;color:var(--muted);font-size:12.5px;line-height:1.3}
    .progress{min-width:260px;display:flex;flex-direction:column;gap:8px;align-items:flex-end}
    .ptext{color:var(--muted);font-size:12.5px}
    .bar{width:260px;height:10px;border-radius:999px;background:#eef2ff;border:1px solid var(--line);overflow:hidden}
 .bar > div{
  height:100%;
  width:0;
  background: linear-gradient(90deg, var(--accent2), var(--accent));
  border-radius:999px
}

 border-radius:999px}
    @media (max-width:860px){ .progress{min-width:180px} .bar{width:180px} }

    /* question card */
    .card{
      border:1px solid var(--line);
      background: var(--card);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .hd{
      padding:14px 16px;border-bottom:1px solid var(--line);
      display:flex;gap:12px;align-items:flex-start;justify-content:space-between
    }
 .qno{
  font-weight:900;
  color:#fff;
  background: rgba(79,70,229,.92);
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  white-space:nowrap
}

    .qtext{flex:1}
    .qtext .qtitle{margin:0 0 6px;font-weight:900}
    .qtext .qdesc{margin:0;color:var(--muted);font-size:13px;line-height:1.55}
    .body{padding:14px 16px}
    .hint{color:var(--muted);font-size:12.5px;margin:0 0 10px;line-height:1.45}

    /* sort UI */
    .rankbox{display:grid;grid-template-columns:repeat(6, minmax(0,1fr));gap:10px;margin-bottom:12px}
    .slot{
      border:1px dashed rgba(109,118,138,.35);
      background: #fbfcff;
      border-radius:14px;
      min-height:62px;
      padding:8px 8px 10px;
      display:flex;flex-direction:column;gap:6px;justify-content:center
    }
    .slot .lab{font-size:11px;color:var(--muted)}
    .slot .pick{
      font-size:13px;font-weight:900;line-height:1.15;
      display:flex;align-items:center;justify-content:space-between;gap:8px
    }
    .slot .x{
      font-size:12px;color:#b11212;
      border:1px solid rgba(224,106,106,.45);
      background: rgba(224,106,106,.10);
      padding:2px 8px;border-radius:999px;cursor:pointer;
      opacity:.95
    }
    .slot.empty .pick{color:rgba(27,31,42,.35);font-weight:800}

    .chips{display:flex;flex-wrap:wrap;gap:10px}
    .chip{
      padding:12px 12px;border-radius:14px;
      border:1px solid var(--line);
      background: #ffffff;
      cursor:pointer;user-select:none;
      display:flex;align-items:center;justify-content:center;
      min-width:150px;
      font-weight:900;
      transition:.15s transform,.15s border-color,.15s box-shadow;
      box-shadow: 0 3px 10px rgba(15,23,42,.05);
    }
    .chip:hover{transform:translateY(-1px);border-color:rgba(124,92,255,.35)}
    .chip.disabled{opacity:.45;cursor:not-allowed;transform:none}

    /* scale UI */
    .scale{display:grid;gap:12px}
    .row{
      border:1px solid var(--line);
      background: #fbfcff;
      border-radius:14px;padding:10px 12px
    }
    .rowtop{display:flex;gap:10px;align-items:center;justify-content:space-between}
    .lbl{font-weight:900}
    .pill{font-size:11px;color:var(--muted);border:1px solid rgba(109,118,138,.25);padding:2px 8px;border-radius:999px}
    .scoreline{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:10px;flex-wrap:wrap}
    .scoreBtns{display:flex;gap:6px;flex-wrap:wrap}
    .sbtn{
      width:36px;height:34px;border-radius:12px;
      border:1px solid rgba(109,118,138,.25);
      background: #ffffff;
      color:var(--ink);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;font-weight:900;
      transition:.12s transform,.12s border-color,.12s background
    }
    .sbtn:hover{transform:translateY(-1px);border-color:rgba(124,92,255,.35)}
  .sbtn.active{
  background: rgba(31,168,168,.12);
  border-color: rgba(31,168,168,.55);
  box-shadow: 0 0 0 3px rgba(31,168,168,.10) inset;
}

    .ends{display:flex;gap:8px;color:var(--muted);font-size:11px;white-space:nowrap}

    /* nav */
    .nav{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-top:14px}
    .leftNav{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    button{
      border:1px solid var(--line);
      background: #ffffff;
      color:var(--ink);
      padding:10px 12px;border-radius:14px;
      cursor:pointer;transition:.15s transform, .15s border-color;
      font-weight:900
    }
    button:hover{transform:translateY(-1px);border-color:rgba(31,168,168,.35)}
    button:active{transform:translateY(0)}
  .primary{
  background: linear-gradient(180deg, rgba(31,168,168,.98), rgba(79,70,229,.86));
  color:#fff;
  border-color:rgba(31,168,168,.45)
}

    .ghost{background:transparent}
    .danger{border-color:rgba(224,106,106,.55)}
    .danger:hover{border-color:rgba(224,106,106,.85)}
    .msg{color:var(--muted);font-size:12.5px}

    /* ========== RESULT PAGE (match screenshot) ========== */
    .section{
      border:1px solid var(--line);
      border-radius:16px;
      background:#fff;
      box-shadow: var(--shadow);
      overflow:hidden;
      margin-top:14px;
    }
    .secHead{
      background: var(--purple);
      color:#fff;
      padding:14px 18px;
      font-weight:900;
      letter-spacing:.2px;
      display:flex;align-items:center;gap:10px;
      font-size:22px;
    }
    .secBody{padding:16px 18px 18px}
    .namebar{
      background: var(--bluebar);
      border-radius:16px;
      padding:16px 18px;
      display:flex;gap:18px;align-items:center;flex-wrap:wrap;
      font-weight:900;
      color:#1c6fb8;
      margin-bottom:14px;
    }
    .namebar .lab{font-size:28px}
    .namebar .sub{font-size:28px}
    .namebar input{
      border:1px solid rgba(28,111,184,.25);
      border-radius:12px;
      padding:10px 12px;
      font-size:16px;
      font-weight:800;
      outline:none;
      min-width:220px;
      background:#fff;
    }

    .analysisGrid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width:900px){ .analysisGrid{grid-template-columns:1fr} }

    .barList{display:grid;gap:14px}
    .barItem{display:grid;grid-template-columns: 34px 92px 1fr 70px;gap:12px;align-items:center}
    .bubble{
      width:30px;height:30px;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-weight:900;
      font-size:14px;
    }
    .tname{font-weight:900;font-size:22px}
    .track2{
      height:18px;border-radius:10px;background:#f3f5fb;
      position:relative;overflow:hidden;border:1px solid #eef1f7;
    }
    .fill2{height:100%;width:0;border-radius:10px}
    .scoreTag{
      font-weight:900;
      color:#fff;
      padding:6px 10px;
      border-radius:10px;
      text-align:center;
      font-size:14px;
      min-width:66px;
    }

    .ruleBox{
      color:#3b3f4b;
      font-size:18px;
      line-height:1.8;
      padding-top:6px;
    }
    .ruleBox b{font-weight:900}
    .ruleBox .hi{color:#e53935;font-weight:900}
    .ruleBox .mid{color:#f59e0b;font-weight:900}
    .ruleBox .lo{color:#3b82f6;font-weight:900}

    .resultCode{
      margin-top:16px;
      background: var(--bluebar);
      border-radius:16px;
      padding:16px 18px;
      font-weight:900;
      color:#1c6fb8;
      font-size:26px;
    }
    .resultCode span{color:#1aa3a3}

    .pillBtns{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:16px}
    .pillBtn{
      background:#4aaaf0;
      color:#fff;
      font-weight:900;
      border-radius:16px;
      padding:12px 18px;
      border:none;
      cursor:pointer;
      box-shadow: 0 10px 18px rgba(74,170,240,.22);
      font-size:22px;
    }
    .pillBtn:hover{filter:brightness(.97)}

    /* Guide section */
    .guideGrid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:16px;
      align-items:stretch;
    }
    @media (max-width:900px){ .guideGrid{grid-template-columns:1fr} }

    .guideCard{
      border:1px solid var(--line);
      border-radius:0;
      background:#fff;
      min-height:320px;
      display:flex;
      flex-direction:column;
    }
    .guideTitle{
      font-weight:900;
      font-size:26px;
      color:#fff;
      padding:16px 16px;
      text-align:center;
    }
    .gBody{
      padding:16px 18px;
      color:#60656f;
      font-size:20px;
      line-height:1.75;
      flex:1;
    }
    .imgCard{
      border:1px solid var(--line);
      background:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      min-height:320px;
    }
    .clarity{
      margin-top:16px;
      font-size:22px;
      font-weight:900;
      color:#2c7bd3;
    }
    .clarityNote{
      margin-top:8px;
      color:#5b6270;
      font-size:20px;
      line-height:1.7;
    }

    /* small helper */
    .gap{height:12px}
  </style>
</head>

<body>
  <div class="wrap">

    <!-- Question header (hidden on result) -->
    <div class="topbar" id="topbar">
      <div class="title">
        <h1>Hollandæ¸¬é©—ï¼ˆ10é¡Œï¼‰</h1>
        <p id="subtitle">è«‹ä¾ç›´è¦ºä½œç­”</p>
      </div>
      <div class="progress">
        <div class="ptext" id="ptext">ç¬¬ 1 / 11 é </div>
        <div class="bar"><div id="pbar"></div></div>
      </div>
    </div>

    <div class="card" id="pageCard"></div>

  </div>

<script>
/** ====== RIASECï¼ˆå…§éƒ¨è¨ˆåˆ† & çµæœå‘ˆç¾ç”¨ï¼‰ ====== */
const RIASEC = [
  { key:"R", name:"å¯¦åšå‹",  desc:"å–œæ­¡å‹•æ‰‹åšã€å·¥å…·è¨­å‚™ã€æŠŠæ±è¥¿ä¿®å¥½åšå‡ºä¾†ã€‚", emoji:"ğŸ”§" },
  { key:"I", name:"ç ”ç©¶å‹",  desc:"å–„æ–¼è§€å¯Ÿã€æ€è€ƒã€åˆ†ææ¨ç†ï¼Œå–œæ­¡ç”¨é ­è…¦è§£æ±ºå•é¡Œä¸¦è¿½æ ¹ç©¶åº•ã€‚", emoji:"ğŸ”" },
  { key:"A", name:"è—è¡“å‹",  desc:"é‡è¦–å‰µæ„èˆ‡ç¾æ„Ÿï¼Œå–œæ­¡è¡¨é”é¢¨æ ¼ã€è¨­è¨ˆã€ç™¼æƒ³ã€‚", emoji:"ğŸ¨" },
  { key:"S", name:"ç¤¾äº¤å‹",  desc:"æ¨‚æ–¼åŠ©äººã€å–œæ­¡äº’å‹•èˆ‡å¼•å°ï¼Œé‡è¦–äººçš„æ„Ÿå—ã€‚", emoji:"ğŸ¤" },
  { key:"E", name:"ä¼æ¥­å‹",  desc:"ç²¾åŠ›æ—ºç››ã€å–œæ­¡ç«¶çˆ­èˆ‡å½±éŸ¿ä»–äººï¼Œæ“…é•·æ¨å‹•èˆ‡èªªæœã€‚", emoji:"ğŸ“£" },
  { key:"C", name:"å¸¸è¦å‹",  desc:"è¬¹æ…æœ‰æ¢ç†ï¼Œå–œæ­¡è¦çŸ©èˆ‡ç²¾ç¢ºï¼Œæ“…é•·æ•´ç†èˆ‡æµç¨‹ã€‚", emoji:"ğŸ—‚ï¸" },
];
const keyToMeta = Object.fromEntries(RIASEC.map(x => [x.key, x]));
/** ====== èˆˆè¶£å°èˆªï¼šç™½è©±è§£æï¼ˆåŠ å¼·ç‰ˆï¼‰ ====== */
const TYPE_GUIDE = {
  A: {
    tagline: "é éˆæ„Ÿåƒé£¯çš„äºº",
    bullets: [
      "å–œæ­¡å‰µæ„ã€è¨­è¨ˆã€è¡¨é”è‡ªæˆ‘ï¼Œå°ç¾æ„Ÿå¾ˆæ•æ„Ÿï¼Œè…¦ä¸­å¸¸å¸¸å¾ˆå¤šé»å­",
      "é©åˆç•«ç•«ã€å¯«ä½œã€è¨­è¨ˆã€è¡¨æ¼”é€™ç¨®å¯ä»¥è‡ªç”±ç™¼æ®çš„å·¥ä½œ",
      "ä¸å¤ªæ„›è¢«è¦å‰‡ç¶ä½ï¼Œå¯¦å‹™ç´°ç¯€å’Œç‘£äº‹æ¯”è¼ƒå®¹æ˜“è¦ºå¾—ç…©",
    ],
  },
  C: {
    tagline: "æœƒæŠŠäº‹æƒ…æ•´ç†å¥½çš„äºº",
    bullets: [
      "å–œæ­¡æœ‰æµç¨‹ã€æœ‰è¦å‰‡ã€æœ‰è¡¨æ ¼çš„å·¥ä½œï¼Œé‡è¦–ç©©å®šèˆ‡ç§©åº",
      "å¾ˆé©åˆè¡Œæ”¿ã€æœƒè¨ˆã€æ–‡æ›¸ã€å°ˆæ¡ˆç®¡ç†",
      "åšäº‹ç´°å¿ƒè² è²¬ï¼Œä½†å°è®ŠåŒ–å’Œè‡¨æ™‚æ”¹å‹•æ¯”è¼ƒæ²’é‚£éº¼å–œæ­¡",
    ],
  },
  E: {
    tagline: "å¤©ç”Ÿå¸¶é ­è¡çš„äºº",
    bullets: [
      "å–œæ­¡ä¸»å°ã€èªªæœã€å½±éŸ¿ä»–äººï¼Œæœ‰ä¼åœ–å¿ƒå’Œè¡Œå‹•åŠ›",
      "é©åˆå‰µæ¥­ã€æ¥­å‹™ã€ä¸»ç®¡ã€è¡ŒéŠ·ã€å¸¶åœ˜éšŠ",
      "æœ‰æ™‚æœƒæ¯”è¼ƒæ€¥ã€é‡çµæœï¼Œç´°ç¯€å’Œè€å¿ƒè¦é åˆ¥äººè£œ",
    ],
  },
  I: {
    tagline: "è…¦åŠ›å‹ç©å®¶",
    bullets: [
      "å–œæ­¡åˆ†æã€ç ”ç©¶ã€æ‰¾ç­”æ¡ˆï¼Œå°æ•¸å­—ã€ç†è«–ã€é‚è¼¯æœ‰èˆˆè¶£",
      "é©åˆå·¥ç¨‹å¸«ã€ç ”ç©¶å“¡ã€æ•¸æ“šåˆ†æã€é¡§å•",
      "æ¯”è¼ƒäº«å—ç¨ç«‹å·¥ä½œï¼Œç¤¾äº¤å’Œæƒ…ç·’è¡¨é”ä¸æ˜¯æœ€å¼·é …",
    ],
  },
  R: {
    tagline: "å‹•æ‰‹åšæœ€å®‰å¿ƒ",
    bullets: [
      "å–œæ­¡å¯¦éš›æ“ä½œã€ä¿®ç†ã€å»ºé€ ï¼Œçœ‹å¾—åˆ°æˆæœæœ€æœ‰æˆå°±æ„Ÿ",
      "é©åˆå·¥ç¨‹ã€æŠ€è¡“ã€ç¶­ä¿®ã€æˆ¶å¤–å·¥ä½œ",
      "ä¸å¤ªæ„›ç©ºè«‡ç†è«–ï¼Œæ¯”è¼ƒä¸æ“…é•·è¡¨é”å…§å¿ƒæ„Ÿå—",
    ],
  },
  S: {
    tagline: "ç‚ºäº†äººè€Œå­˜åœ¨çš„äºº",
    bullets: [
      "å–œæ­¡å¹«åŠ©åˆ¥äººã€èŠå¤©ã€é™ªä¼´ã€æ•™å­¸ï¼Œå¾ˆæœ‰åŒç†å¿ƒ",
      "é©åˆè€å¸«ã€ç¤¾å·¥ã€è«®è©¢ã€å®¢æœã€æ•™ç·´",
      "æ€•è¡çªã€ä¸å¤ªæ„›åšå†·å†°å†°çš„æ±ºç­–",
    ],
  },
};

/** ====== é¡Œåº«ï¼š1~6 æ’åºé¡Œï¼ˆUIä¸é¡¯ç¤ºå‹åˆ¥ï¼‰ ====== */
const sortQuestions = [
  { id:1, title:"æ–°å‰µå…¬å¸å°ˆæ¡ˆ",
    desc:"ä½ å‰›åŠ å…¥ä¸€é–“æ–°å‰µå…¬å¸ï¼Œåœ˜éšŠæ­£åœ¨é–‹ç™¼å…¨æ–°ç”¢å“ï¼Œè€é—†è«‹å¤§å®¶è‡ªè¡Œé¸æ“‡æœ€æƒ³æŠ•å…¥çš„å·¥ä½œå…§å®¹ï¼Œè«‹ä¾ç…§ä½ å…§å¿ƒçœŸå¯¦åå¥½æ’åº",
    options:[ {text:"çµ„è£æ¸¬è©¦",type:"R"},{text:"æ•¸æ“šåˆ†æ",type:"I"},{text:"è¦–è¦ºè¨­è¨ˆ",type:"A"},{text:"åœ˜éšŠé—œæ‡·",type:"S"},{text:"å°å¤–è¡ŒéŠ·",type:"E"},{text:"æ–‡ä»¶æ•´ç†",type:"C"} ]
  },
  { id:2, title:"å¤§å‹æ´»å‹•ç±Œå‚™",
    desc:"ä½ åƒèˆ‡ä¸€å ´å¤§å‹æ´»å‹•çš„ç±Œå‚™åœ˜éšŠï¼Œå¤§å®¶å¯ä»¥è‡ªç”±é¸æ“‡æœ€æƒ³è² è²¬çš„å·¥ä½œå…§å®¹ï¼Œæ²’æœ‰å°éŒ¯ï¼Œåªçœ‹ä½ çš„çœŸå¯¦åå¥½",
    options:[ {text:"æ¶è¨­è¨­å‚™",type:"R"},{text:"æµç¨‹è¦åŠƒ",type:"I"},{text:"ä¸»è¦–è¦ºè¨­è¨ˆ",type:"A"},{text:"æ¥å¾…ä¾†è³“",type:"S"},{text:"æ‹›å‹Ÿè´ŠåŠ©",type:"E"},{text:"åå–®ç®¡ç†",type:"C"} ]
  },
  { id:3, title:"ç ”ç©¶è¨ˆç•«åœ˜éšŠ",
    desc:"ä½ è¢«é‚€è«‹åŠ å…¥è·¨é ˜åŸŸç ”ç©¶è¨ˆç•«ï¼Œåœ˜éšŠéœ€è¦åˆ†å·¥åˆä½œå®Œæˆä»»å‹™ï¼Œè«‹ä¾ä½ æœ€æƒ³æŠ•å…¥çš„è§’è‰²æ’åº",
    options:[ {text:"æ“ä½œå„€å™¨",type:"R"},{text:"é‚è¼¯æ¨ç†",type:"I"},{text:"ç™¼æƒ³æ¦‚å¿µ",type:"A"},{text:"å¼•å°å—è©¦è€…",type:"S"},{text:"æˆæœç™¼è¡¨",type:"E"},{text:"æ•¸æ“šæ•´ç†",type:"C"} ]
  },
  { id:4, title:"æ—…è¡Œçªç™¼ç‹€æ³",
    desc:"ä½ å’Œæœ‹å‹å‡ºåœ‹æ—…è¡Œæ™‚é‡åˆ°çªç™¼ç‹€æ³ï¼ŒåŸå®šè¡Œç¨‹è¢«æ‰“äº‚ï¼Œå¤§å®¶éœ€è¦è‡¨æ™‚åˆ†å·¥è™•ç†ï¼Œè«‹ä¾ä½ è‡ªç„¶æœƒæƒ³åšçš„äº‹æ’åº",
    options:[ {text:"è™•ç†äº¤é€šæ–¹å¼",type:"R"},{text:"é‡æ–°è¦åŠƒè·¯ç·š",type:"I"},{text:"æƒ³æ–°ç©æ³•",type:"A"},{text:"å®‰æ’«åœ˜å“¡",type:"S"},{text:"å”å•†æºé€š",type:"E"},{text:"æ›´æ–°è¡Œç¨‹",type:"C"} ]
  },
  { id:5, title:"ç¶“ç‡Ÿè‡ªåª’é«”",
    desc:"ä½ è¦å’Œæœ‹å‹ä¸€èµ·ç¶“ç‡Ÿè‡ªåª’é«”é »é“ï¼Œæ¯å€‹äººåˆ†å·¥åˆä½œï¼Œè«‹ä¾ä½ æœ€æƒ³è² è²¬çš„éƒ¨åˆ†æ’åº",
    options:[ {text:"æ‹æ”å‰ªè¼¯",type:"R"},{text:"ä¸»é¡Œç ”ç©¶",type:"I"},{text:"å…§å®¹å‰µæ„",type:"A"},{text:"ç¤¾ç¾¤äº’å‹•",type:"S"},{text:"å•†æ¥­åˆä½œ",type:"E"},{text:"å¾Œå°ç®¡ç†",type:"C"} ]
  },
  { id:6, title:"ä»»å‹™æ¨¡æ“¬ç³»çµ±",
    desc:"ä½ é€²å…¥ä¸€å€‹ä»»å‹™æ¨¡æ“¬ç³»çµ±ï¼Œåªèƒ½é¸æ“‡ä¸€å€‹ä¸»è¦è§’è‰²ä¾†å®Œæˆä»»å‹™ï¼Œè«‹ä¾ä½ æœ€æƒ³æ‰®æ¼”çš„è§’è‰²æ’åº",
    options:[ {text:"ä¿®å¾©ç³»çµ±",type:"R"},{text:"å•é¡Œåˆ†æ",type:"I"},{text:"å‰µæ„ç­–ç•¥",type:"A"},{text:"å¿ƒç†æ”¯æ´",type:"S"},{text:"ä»»å‹™æŒ‡æ®",type:"E"},{text:"è³‡è¨Šç®¡ç†",type:"C"} ]
  },
];

/** ====== é¡Œåº«ï¼š7~10 é‡è¡¨é¡Œï¼ˆé» 1~7ï¼›UIä¸é¡¯ç¤ºå‹åˆ¥ï¼‰ ====== */
const scaleSets = [
  { id:7, title:"å€‹æ€§å‚¾å‘é‡è¡¨",
    desc:"è«‹ä¾ä½ çœŸå¯¦çš„å€‹æ€§é¸æ“‡ç¬¦åˆç¨‹åº¦",
    left:"æœ€ä¸ç¬¦åˆ", right:"æœ€ç¬¦åˆ",
    items:[
      {text:"å–œæ­¡å‹•æ‰‹åšäº‹",type:"R"},{text:"åå¥½ç›´æ¥è¡Œå‹•",type:"R"},
      {text:"æ„›è¿½æ ¹ç©¶åº•",type:"I"},{text:"å°æ–°çŸ¥å¥½å¥‡",type:"I"},
      {text:"é‡è¦–ç¾æ„Ÿå‰µæ„",type:"A"},{text:"å–œæ­¡è‡ªæˆ‘è¡¨é”",type:"A"},
      {text:"å®¹æ˜“æ„Ÿå—ä»–äºº",type:"S"},{text:"å–œæ­¡å¹«äººæˆé•·",type:"S"},
      {text:"äº«å—å½±éŸ¿ä»–äºº",type:"E"},{text:"æƒ³å¸¶é ˜æ¨å‹•",type:"E"},
      {text:"å–œæ­¡è¦å‰‡æµç¨‹",type:"C"},{text:"åšäº‹æ³¨æ„ç´°ç¯€",type:"C"},
    ]
  },
  { id:8, title:"æ´»å‹•èˆˆè¶£é‡è¡¨",
    desc:"è«‹ä¾ä½ å°ä»¥ä¸‹æ´»å‹•çš„å–œå¥½ä½œç­”",
    left:"æœ€ä¸å–œæ­¡", right:"æœ€å–œæ­¡",
    items:[
      {text:"æ“ä½œå·¥å…·è¨­å‚™",type:"R"},{text:"DIY çµ„è£å®‰è£",type:"R"},
      {text:"è’é›†è³‡æ–™åˆ†æ",type:"I"},{text:"è§£æ±ºé‚è¼¯é›£é¡Œ",type:"I"},
      {text:"ç¹ªç•«è¨­è¨ˆä½œå“",type:"A"},{text:"ç™¼æƒ³å‰µæ„é»å­",type:"A"},
      {text:"é—œå¿ƒä»–äººç‹€æ…‹",type:"S"},{text:"æ•™å°é™ªä¼´ä»–äºº",type:"S"},
      {text:"èªªæœå½±éŸ¿ä»–äºº",type:"E"},{text:"ä¸»å°åœ˜é«”æ´»å‹•",type:"E"},
      {text:"æ•´ç†æ–‡ä»¶è³‡æ–™",type:"C"},{text:"å»ºç«‹æµç¨‹ç³»çµ±",type:"C"},
    ]
  },
  { id:9, title:"è·æ¥­å–œå¥½é‡è¡¨",
    desc:"ä¸è€ƒæ…®èƒ½åŠ›èˆ‡ç¾å¯¦æ¢ä»¶ï¼Œè«‹ä¾ä½ å°è·æ¥­çš„ç›´è¦ºå–œå¥½ä½œç­”",
    left:"æœ€ä¸å–œæ­¡", right:"æœ€å–œæ­¡",
    items:[
      {text:"è¨­å‚™ç¶­ä¿®äººå“¡",type:"R"},{text:"å·¥ç¨‹æŠ€è¡“äººå“¡",type:"R"},
      {text:"ç ”ç©¶åˆ†æäººå“¡",type:"I"},{text:"æ•¸æ“šç§‘å­¸å·¥ä½œ",type:"I"},
      {text:"è¦–è¦ºè¨­è¨ˆå·¥ä½œ",type:"A"},{text:"å…§å®¹å‰µä½œå·¥ä½œ",type:"A"},
      {text:"å¿ƒç†è¼”å°å·¥ä½œ",type:"S"},{text:"æ•™è‚²æ•™å­¸å·¥ä½œ",type:"S"},
      {text:"è¡ŒéŠ·ä¼åŠƒä¸»ç®¡",type:"E"},{text:"å‰µæ¥­ç¶“ç‡Ÿè€…",type:"E"},
      {text:"è¡Œæ”¿ç®¡ç†äººå“¡",type:"C"},{text:"æœƒè¨ˆäº‹å‹™äººå“¡",type:"C"},
    ]
  },
  { id:10, title:"èƒ½åŠ›è‡ªè©•é‡è¡¨",
    desc:"è«‹ä¾ä½ å°è‡ªèº«èƒ½åŠ›çš„æ„Ÿè¦ºä½œç­”",
    left:"æœ€ä¸ç¬¦åˆ", right:"æœ€ç¬¦åˆ",
    items:[
      {text:"èƒ½æ“ä½œå·¥å…·è¨­å‚™",type:"R"},{text:"èƒ½è§£æ±ºæŠ€è¡“å•é¡Œ",type:"R"},
      {text:"æ“…é•·åˆ†ææ¨ç†",type:"I"},{text:"èƒ½ç†è§£è¤‡é›œæ¦‚å¿µ",type:"I"},
      {text:"èƒ½å‰µä½œæˆ–è¨­è¨ˆ",type:"A"},{text:"æƒ³åƒåŠ›å¾ˆè±å¯Œ",type:"A"},
      {text:"èƒ½é«”å¯Ÿä»–äººæƒ…ç·’",type:"S"},{text:"äººéš›ç›¸è™•å¾ˆé †",type:"S"},
      {text:"èƒ½å½±éŸ¿ä»–äººæ±ºç­–",type:"E"},{text:"èƒ½å¸¶é ˜åœ˜éšŠè¡Œå‹•",type:"E"},
      {text:"å–„æ–¼è¦åŠƒèˆ‡æ•´ç†",type:"C"},{text:"åšäº‹ç´°å¿ƒæœ‰æ¢ç†",type:"C"},
    ]
  }
];

/** ====== Pages ====== */
const pages = [
  ...sortQuestions.map(q => ({ kind:"sort", id:q.id, data:q })),
  ...scaleSets.map(s => ({ kind:"scale", id:s.id, data:s })),
  { kind:"result", id:11, data:null },
];

/** ====== State ====== */
const state = {
  pageIndex: 0,
  sortAnswers: {},
  scaleAnswers: {},
  userName: "",
};

const pageCard = document.getElementById("pageCard");
const ptext = document.getElementById("ptext");
const pbar = document.getElementById("pbar");
const subtitle = document.getElementById("subtitle");
const topbar = document.getElementById("topbar");

function renderPage(){
  const page = pages[state.pageIndex];
  pageCard.innerHTML = "";

  if (page.kind === "result"){
    topbar.style.display = "none";
    pageCard.style.display = "none"; // ç”¨ section æ–¹å¼ç•«çµæœ
    renderResultSections();
    window.scrollTo({top:0, behavior:"smooth"});
    return;
  }

  // questions
  topbar.style.display = "flex";
  pageCard.style.display = "block";
  pageCard.innerHTML = "";
  updateHeader();

  if (page.kind === "sort") pageCard.appendChild(renderSortPage(page.data));
  if (page.kind === "scale") pageCard.appendChild(renderScalePage(page.data));
}

function updateHeader(){
  const cur = state.pageIndex + 1;
  const total = pages.length;
  ptext.textContent = `ç¬¬ ${cur} / ${total} é `;
  pbar.style.width = `${(cur/total)*100}%`;

}

/** ====== Sort Page ====== */
function renderSortPage(q){
  const frag = document.createElement("div");

  const hd = document.createElement("div");
  hd.className = "hd";
  hd.innerHTML = `
    <div class="qno">é¡Œç›® ${q.id}</div>
    <div class="qtext">
      <p class="qtitle">${esc(q.title)}</p>
      <p class="qdesc">${esc(q.desc)}</p>
    </div>
  `;
  frag.appendChild(hd);

  const body = document.createElement("div");
  body.className = "body";

  const hint = document.createElement("p");
  hint.className = "hint";
  body.appendChild(hint);

  const picks = state.sortAnswers[q.id] || [];

  const rankbox = document.createElement("div");
  rankbox.className = "rankbox";
  for (let r=0; r<6; r++){
    const optIdx = picks[r];
    const isEmpty = (optIdx === undefined);
    const slot = document.createElement("div");
    slot.className = "slot" + (isEmpty ? " empty" : "");
    slot.innerHTML = `
      <div class="lab">ç¬¬ ${r+1} å</div>
      <div class="pick">
        <span>${esc(isEmpty ? "ï¼ˆå°šæœªé¸æ“‡ï¼‰" : q.options[optIdx].text)}</span>
        ${isEmpty ? "" : `<span class="x" data-r="${r}">Ã—</span>`}
      </div>
    `;
    rankbox.appendChild(slot);
  }
  body.appendChild(rankbox);

  const chips = document.createElement("div");
  chips.className = "chips";
  q.options.forEach((opt, idx) => {
    const used = picks.includes(idx);
    const chip = document.createElement("div");
    chip.className = "chip" + (used ? " disabled" : "");
    chip.textContent = opt.text;
    chip.addEventListener("click", () => {
      if (used) return;
      const cur = state.sortAnswers[q.id] ? [...state.sortAnswers[q.id]] : [];
      if (cur.length >= 6) return;
      cur.push(idx);
      state.sortAnswers[q.id] = cur;
      renderPage();
    });
    chips.appendChild(chip);
  });
  body.appendChild(chips);

  body.addEventListener("click", (e) => {
    const x = e.target.closest(".x");
    if (!x) return;
    const r = Number(x.dataset.r);
    const cur = state.sortAnswers[q.id] ? [...state.sortAnswers[q.id]] : [];
    cur.splice(r, 1);
    if (cur.length) state.sortAnswers[q.id] = cur;
    else delete state.sortAnswers[q.id];
    renderPage();
  });

  body.appendChild(renderNav({
    canPrev: state.pageIndex > 0,
    canNext: picks.length === 6,
    nextLabel: (state.pageIndex === pages.length - 2) ? "çœ‹çµæœ" : "ä¸‹ä¸€é¡Œ",
    onPrev: () => { state.pageIndex--; renderPage(); window.scrollTo({top:0,behavior:"smooth"}); },
    onNext: () => { state.pageIndex++; renderPage(); window.scrollTo({top:0,behavior:"smooth"}); },
    extraLeftButtons: [
      { label:"é‡æ–°é¸æ“‡", className:"ghost danger", onClick: () => { delete state.sortAnswers[q.id]; renderPage(); } }
    ],
  }));

  frag.appendChild(body);
  return frag;
}

/** ====== Scale Page (require all items chosen) ====== */
function renderScalePage(set){
  const frag = document.createElement("div");

  const hd = document.createElement("div");
  hd.className = "hd";
  hd.innerHTML = `
    <div class="qno">é¡Œç›® ${set.id}</div>
    <div class="qtext">
      <p class="qtitle">${esc(set.title)}</p>
      <p class="qdesc">${esc(set.desc)}</p>
    </div>
  `;
  frag.appendChild(hd);

  const body = document.createElement("div");
  body.className = "body";

  const hint = document.createElement("p");
  hint.className = "hint";
  body.appendChild(hint);

  if (!state.scaleAnswers[set.id]) state.scaleAnswers[set.id] = {};

  const scale = document.createElement("div");
  scale.className = "scale";

  set.items.forEach((it, idx) => {
    const v = state.scaleAnswers[set.id][idx] ?? null;

    const row = document.createElement("div");
    row.className = "row";
    row.innerHTML = `
      <div class="rowtop">
        <div class="lbl">${esc(it.text)}</div>
        <div><span class="pill" id="sv-${set.id}-${idx}">åˆ†æ•¸ï¼š${v ?? "æœªé¸"}</span></div>
      </div>
      <div class="scoreline">
        <div class="ends"><span>${esc(set.left)}ï¼ˆ1ï¼‰</span></div>
        <div class="scoreBtns"></div>
        <div class="ends"><span>${esc(set.right)}ï¼ˆ7ï¼‰</span></div>
      </div>
    `;

    const btnWrap = row.querySelector(".scoreBtns");
    for (let s=1; s<=7; s++){
      const b = document.createElement("div");
      b.className = "sbtn" + (s === v ? " active" : "");
      b.textContent = String(s);
      b.addEventListener("click", () => {
        state.scaleAnswers[set.id][idx] = s;
        btnWrap.querySelectorAll(".sbtn").forEach(x => x.classList.remove("active"));
        b.classList.add("active");
        row.querySelector(`#sv-${set.id}-${idx}`).textContent = `åˆ†æ•¸ï¼š${s}`;
        updateNavState(set);
      });
      btnWrap.appendChild(b);
    }

    scale.appendChild(row);
  });

  body.appendChild(scale);

  const nav = renderNav({
    canPrev: state.pageIndex > 0,
    canNext: isScaleComplete(set.id, set.items.length),
    nextLabel: (state.pageIndex === pages.length - 2) ? "çœ‹çµæœ" : "ä¸‹ä¸€é¡Œ",
    onPrev: () => { state.pageIndex--; renderPage(); window.scrollTo({top:0,behavior:"smooth"}); },
    onNext: () => { state.pageIndex++; renderPage(); window.scrollTo({top:0,behavior:"smooth"}); },
    extraLeftButtons: [
      { label:"å…¨éƒ¨æ¸…é™¤", className:"ghost danger", onClick: () => { state.scaleAnswers[set.id] = {}; renderPage(); } }
    ],
    note: scaleNote(set.id, set.items.length)
  });
  nav.id = "nav";
  body.appendChild(nav);

  frag.appendChild(body);
  return frag;
}

function renderNav({canPrev, canNext, nextLabel, onPrev, onNext, extraLeftButtons=[], note=""}){
  const nav = document.createElement("div");
  nav.className = "nav";

  const left = document.createElement("div");
  left.className = "leftNav";

  extraLeftButtons.forEach(b => {
    const btn = document.createElement("button");
    btn.className = b.className || "ghost";
    btn.textContent = b.label;
    btn.addEventListener("click", b.onClick);
    left.appendChild(btn);
  });

  if (canPrev){
    const prev = document.createElement("button");
    prev.className = "ghost";
    prev.textContent = "ä¸Šä¸€é¡Œ";
    prev.addEventListener("click", onPrev);
    left.appendChild(prev);
  }

  const right = document.createElement("div");
  right.className = "leftNav";

  const msg = document.createElement("div");
  msg.className = "msg";
  msg.id = "navMsg";
  msg.textContent = note;

  const next = document.createElement("button");
  next.className = "primary";
  next.textContent = nextLabel;
  next.disabled = !canNext;
  if (next.disabled){
    next.style.opacity = ".45";
    next.style.cursor = "not-allowed";
    next.style.transform = "none";
  }
  next.addEventListener("click", () => {
    if (!next.disabled) onNext();
  });

  right.appendChild(msg);
  right.appendChild(next);

  nav.appendChild(left);
  nav.appendChild(right);
  return nav;
}

function updateNavState(set){
  const nav = document.getElementById("nav");
  if (!nav) return;
  const nextBtn = nav.querySelector("button.primary");
  const msg = document.getElementById("navMsg");
  const ok = isScaleComplete(set.id, set.items.length);
  msg.textContent = scaleNote(set.id, set.items.length);

  nextBtn.disabled = !ok;
  nextBtn.style.opacity = ok ? "1" : ".45";
  nextBtn.style.cursor = ok ? "pointer" : "not-allowed";
}

function isScaleComplete(setId, n){
  const a = state.scaleAnswers[setId] || {};
  for (let i=0; i<n; i++){
    const v = a[i];
    if (!(v >= 1 && v <= 7)) return false;
  }
  return true;
}
function scaleNote(setId, n){
  const a = state.scaleAnswers[setId] || {};
  let filled = 0;
  for (let i=0; i<n; i++){
    const v = a[i];
    if (v >= 1 && v <= 7) filled++;
  }
  return (filled === n) ? "å¯ä»¥ä¸‹ä¸€é¡Œ" : `é‚„å·® ${n - filled} å°é¡Œ`;
}

/** ====== Scoring ====== */
function computeRawScores(){
  const score = {R:0,I:0,A:0,S:0,E:0,C:0};

  // sort: rank points 6..1
  sortQuestions.forEach(q => {
    const picks = state.sortAnswers[q.id];
    if (!picks || picks.length !== 6) return;
    for (let rank=0; rank<6; rank++){
      const opt = q.options[picks[rank]];
      score[opt.type] += (6 - rank);
    }
  });

  // scale: direct add 1..7
  scaleSets.forEach(set => {
    const a = state.scaleAnswers[set.id] || {};
    set.items.forEach((it, idx) => {
      score[it.type] += Number(a[idx] ?? 0);
    });
  });

  return score;
}

// max per type: sort max 6*6=36; scale max 8 items per type? here each set has 2 per type => 4 sets => 8 items => 8*7=56; total 92
const MAX_PER_TYPE = 92;

function to100(raw){ return (raw / MAX_PER_TYPE) * 100; }

function getTop3(scoreRaw){
  const sorted = Object.entries(scoreRaw).sort((a,b)=>b[1]-a[1]);
  return sorted.slice(0,3).map(([k,v])=>k);
}

function getClarityLabel(top1){
  // ç”¨ 0~100 çš„ top1 ä¾†åˆ¤æ–·ï¼ˆè·Ÿä½ æˆªåœ–é‚£æ®µè¦å‰‡ä¸€è‡´ï¼‰
  if (top1 >= 70) return "è¼ƒé«˜";
  if (top1 >= 55) return "ä¸­ç­‰";
  return "è¼ƒä½";
}

/** ====== Result Sections (Analysis + Guide) ====== */
function renderResultSections(){
  // remove any previous sections
  document.querySelectorAll(".section").forEach(x => x.remove());

  const raw = computeRawScores();
  const score100 = Object.fromEntries(Object.entries(raw).map(([k,v])=>[k,to100(v)]));
  const top3 = getTop3(raw);
  const code = top3.join("");

  // order fixed like screenshot
  const order = ["E","C","I","S","R","A"];

  const dateStr = formatDate(new Date());
  const top1Score = score100[top3[0]];

  // ===== Analysis
  const sec1 = document.createElement("div");
  sec1.className = "section";
  sec1.innerHTML = `
    <div class="secHead">â—· çµæœåˆ†æ Analysis</div>
    <div class="secBody">
      <div class="namebar">
        <div class="lab">å§“åï¼š</div>
        <input id="nameInput" placeholder="è«‹è¼¸å…¥å§“å" value="${esc(state.userName)}" />
        <div class="sub">æ—¥æœŸï¼š${dateStr}</div>
      </div>

      <div class="analysisGrid">
        <div class="barList" id="barList"></div>

        <div class="ruleBox">
          ä»¥ä¸Šåˆ†æ•¸ç”¨ä¾†è¡¨ç¤ºä½ å°è©²é¡å‹ä¹‹èˆˆè¶£ç¨‹åº¦é«˜ä½ï¼š<br>
          <span class="hi">70åˆ†ä»¥ä¸Š</span>ï¼šèˆˆè¶£ç¨‹åº¦è¼ƒé«˜ï¼Œå¯å„ªå…ˆé¸æ“‡æ­¤é¡å‹ç™¼å±•ã€‚<br>
          <span class="mid">55~69åˆ†</span>ï¼šèˆˆè¶£ç¨‹åº¦ä¸­ç­‰ï¼Œä¸ç‰¹åˆ¥å–œæ­¡ä½†å°šå¯æ¥å—ã€‚<br>
          <span class="lo">54åˆ†ä»¥ä¸‹</span>ï¼šèˆˆè¶£ç¨‹åº¦è¼ƒä½ï¼Œç”šè‡³å¯èƒ½æœ‰äº›æ’æ–¥ã€‚
        </div>
      </div>

      <div class="resultCode">
        ä½ çš„èˆˆè¶£çµæœï¼š <span>${code}</span>
      </div>


      <div class="gap"></div>

      <div class="nav">
        <div class="leftNav">
          <button class="ghost" id="backToQ">å›åˆ°ä¸Šä¸€é¡Œ</button>
          <button class="danger ghost" id="resetAll">å…¨éƒ¨é‡å¡«</button>
        </div>
        <div class="leftNav">
          <button class="primary" id="copyBtn">è¤‡è£½çµæœ</button>
        </div>
      </div>
    </div>
  `;
  document.querySelector(".wrap").appendChild(sec1);

  // draw bars
  const barList = document.getElementById("barList");
  order.forEach(k => {
    const m = keyToMeta[k];
    const v = score100[k];
    const row = document.createElement("div");
    row.className = "barItem";
    row.innerHTML = `
      <div class="bubble" style="background: var(--c${k});">${k}</div>
      <div class="tname">${m.name}</div>
      <div class="track2"><div class="fill2" style="background: var(--c${k}); width:${Math.max(0,Math.min(100,v))}%;"></div></div>
      <div class="scoreTag" style="background: var(--c${k});">${v.toFixed(2)}</div>
    `;
    barList.appendChild(row);
  });

  // name binding
  const nameInput = document.getElementById("nameInput");
  nameInput.addEventListener("input", () => { state.userName = nameInput.value.trim(); });

  // copy/back/reset
  document.getElementById("copyBtn").addEventListener("click", async () => {
    const sorted = Object.entries(score100).sort((a,b)=>b[1]-a[1]);
    const top3txt = sorted.slice(0,3).map(([k,v]) => `${keyToMeta[k].name} ${v.toFixed(2)}`).join(" / ");
    const txt = `å§“åï¼š${state.userName || "ï¼ˆæœªå¡«ï¼‰"}\næ—¥æœŸï¼š${dateStr}\nèˆˆè¶£çµæœï¼š${code}\nTop3ï¼š${top3txt}\nåˆ†æ•¸ï¼š` +
      order.map(k => `${k}:${score100[k].toFixed(2)}`).join(", ");
    try{ await navigator.clipboard.writeText(txt); alert("å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ âœ…"); }
    catch{ prompt("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ï¼š", txt); }
  });

  document.getElementById("backToQ").addEventListener("click", () => {
    // go back to Q10 page
    document.querySelectorAll(".section").forEach(x => x.remove());
    topbar.style.display = "flex";
    pageCard.style.display = "block";
    state.pageIndex = pages.length - 2;
    renderPage();
    window.scrollTo({top:0, behavior:"smooth"});
  });

  document.getElementById("resetAll").addEventListener("click", () => {
    if (!confirm("ç¢ºå®šè¦å…¨éƒ¨é‡å¡«å—ï¼Ÿ")) return;
    state.pageIndex = 0;
    state.sortAnswers = {};
    state.scaleAnswers = {};
    state.userName = "";
    document.querySelectorAll(".section").forEach(x => x.remove());
    topbar.style.display = "flex";
    pageCard.style.display = "block";
    renderPage();
    window.scrollTo({top:0, behavior:"smooth"});
  });

  // ===== Guide
  const sec2 = document.createElement("div");
  sec2.className = "section";
  sec2.innerHTML = `
    <div class="secHead">â–¶ èˆˆè¶£å°èˆª Guide</div>
    <div class="secBody">
      <div class="guideGrid">
        ${guideTypeCard("ä¸»å‹", top3[0], true)}
        ${guideTypeCard("å‰¯å‹", top3[1], false)}
        ${guideTypeCard("å‰¯å‹", top3[2], false)}
      </div>
    </div>
  `;
  document.querySelector(".wrap").appendChild(sec2);
} // âœ… é€™å€‹ä¸€å®šè¦æœ‰ï¼ï¼renderResultSections åˆ°é€™è£¡çµæŸ



function guideTypeCard(roleLabel, typeKey, isMain){
  const m = keyToMeta[typeKey];
  const g = TYPE_GUIDE[typeKey] || { tagline:"", bullets:[] };

const bg = isMain
  ? "linear-gradient(135deg, rgba(79,70,229,.95), rgba(31,168,168,.95))"
  : "linear-gradient(135deg, rgba(242,179,94,.95), rgba(31,168,168,.75))";


  const bulletsHtml = (g.bullets || [])
    .map(t => `<li>${esc(t)}</li>`)
    .join("");

  return `
    <div class="guideCard">
      <div class="guideTitle" style="background:${bg}">
        ${roleLabel}ï¼š${m.name}
      </div>

      <div class="gBody">
        <div style="font-weight:900;color:#2c7bd3;margin-bottom:8px;">
          ${typeKey} ${m.name}ï¼š${esc(g.tagline)}
        </div>

        <ul style="margin:0;padding-left:22px;">
          ${bulletsHtml}
        </ul>

        <div style="margin-top:10px;color:#8a93a3;font-size:16px;line-height:1.6;">
        </div>
      </div>
    </div>
  `;
}

/** ====== Result Nav ====== */
function goToResult(){
  state.pageIndex = pages.length - 1;
  renderPage();
}

/** ====== Utilities ====== */
function esc(str){
  return String(str ?? "")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}
function formatDate(d){
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,"0");
  const dd = String(d.getDate()).padStart(2,"0");
  return `${y}/${m}/${dd}`;
}

/** ====== Init ====== */
renderPage();

// When last question "next" pressed, it naturally goes to result page because pages include result as last page.
// So ensure Q10 next goes to result:
(function patchLastNext(){
  // nothing needed; pages already include result, navigation increments pageIndex.
})();
</script>
</body>
</html>

